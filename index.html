<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Portofolio</title>
    <link rel="stylesheet" href="bootstrap/css/bootstrap.min.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.8.1/font/bootstrap-icons.min.css"
    />
    <link rel="stylesheet" href="style.css" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/gh/devicons/devicon@latest/devicon.min.css"
    />
    <link rel="icon" href="image/logo.png" type="image/x-icon" />
    <!-- Supabase JS CDN -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>
    <!-- AOS CSS -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.css"
    />
  </head>

  <style>
    .container-skill {
      overflow: hidden;
      white-space: nowrap;
      position: relative;
      width: 100%;
      background-color: transparent;
      padding: 20px 0;
    }
    .scrolling-row {
      display: inline-flex;
      animation: scroll-horizontal 15s linear infinite;
    }
    .icon-box {
      text-align: center;
      margin: 0 20px;
    }
    .icon-box i {
      font-size: 3rem;
    }
    /* Animasi scrolling */
    @keyframes scroll-horizontal {
      0% {
        transform: translateX(100%);
      }
      100% {
        transform: translateX(-100%);
      }
    }

    .text-3xl {
      font-size: 2rem;
    }
    .md\:text-4xl {
      font-size: 2.5rem;
    }
    .text-center {
      text-align: center;
      margin: 10px 0;
    }
    .text-blue-400 {
      color: #60a5fa;
    }
    .text-blue-500 {
      color: #3b82f6;
    }
    .text-red-500 {
      color: #ef4444;
    }
    .text-yellow-400 {
      color: #facc15;
    }
    .text-green-500 {
      color: #22c55e;
    }
    .text-purple-500 {
      color: #a855f7;
    }
  </style>

  <body>
    <header class="header navbar navbar-expand-lg navbar-dark fixed-top">
      <div class="container-fluid">
        <a href="#home" class="navbar-brand logo">
          Muhammad Refa <span>Fatur Rahman</span>
        </a>
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarNav"
          aria-controls="navbarNav"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav ms-auto">
            <li class="nav-item">
              <a href="#home" class="nav-link">Home</a>
            </li>
            <li class="nav-item">
              <a href="#about" class="nav-link">About Me</a>
            </li>
            <li class="nav-item">
              <a href="#project" class="nav-link">Project</a>
            </li>
            <li class="nav-item">
              <a href="#skill" class="nav-link">Skill</a>
            </li>
            <li class="nav-item">
              <a href="#serti" class="nav-link">Sertificate</a>
            </li>
            <li class="nav-item">
              <a href="#contact" class="nav-link">Contact Me</a>
            </li>
          </ul>
        </div>
      </div>
    </header>

    <section
      class="home d-flex align-items-center"
      id="home"
      data-aos="fade-up"
    >
      <div class="container">
        <div class="row">
          <div class="col-md-6 d-flex flex-column justify-content-center">
            <div class="home-content">
              <h1>Hi, It's <span>Refa</span></h1>
              <h3 class="text-animation">I'm a <span></span></h3>
              <p>
                I'm an Informatics student at University Binaniaga Indonesia who
                likes design and technology
              </p>
              <!--                         <p id="profile-view-count" class="bi bi-person"></p> -->
            </div>
            <div class="social-icon">
              <a
                href="https://www.instagram.com/refafatur_/?utm_source=ig_web_button_share_sheet"
                style="--i: 1"
                ><i class="bi bi-instagram"></i
              ></a>
              <a
                href="https://www.tiktok.com/@_sixtpy?_t=ZS-8tAMrs1T3Lz&_r=1"
                style="--i: 2"
                ><i class="bi bi-tiktok"></i
              ></a>
              <a
                href="https://www.linkedin.com/in/muhammad-refa-fatur-rahman/"
                style="--i: 3"
                ><i class="bi bi-linkedin"></i
              ></a>
              <a href="https://github.com/refafatur" style="--i: 4"
                ><i class="bi bi-github"></i
              ></a>
            </div>

            <div class="container-skill">
              <div class="scrolling-row">
                <div class="icon-box">
                  <i class="devicon-php-plain text-blue-400"></i>
                </div>
                <div class="icon-box">
                  <i class="devicon-laravel-plain text-red-500"></i>
                </div>
                <div class="icon-box">
                  <i class="devicon-javascript-plain text-yellow-400"></i>
                </div>
                <div class="icon-box">
                  <i class="devicon-nodejs-plain text-green-500"></i>
                </div>
                <div class="icon-box">
                  <i class="devicon-mysql-plain text-blue-400"></i>
                </div>
                <div class="icon-box">
                  <i class="devicon-firebase-plain text-blue-400"></i>
                </div>
                <div class="icon-box">
                  <i class="devicon-flutter-plain text-blue-500"></i>
                </div>
                <div class="icon-box">
                  <i class="devicon-android-plain text-blue-500"></i>
                </div>
                <div class="icon-box">
                  <i class="devicon-css3-plain text-blue-500"></i>
                </div>
                <div class="icon-box">
                  <i class="devicon-bootstrap-plain text-purple-500"></i>
                </div>
              </div>
            </div>

            <div class="btn-group">
              <a href="#contact" class="btn btn-primary">Contact Me</a>
            </div>
            <div class="btn-group">
              <a
                href="CV_Muhammad-Refa-Fatur-Rahman.pdf"
                class="btn btn-secondary"
                download
                >Download CV</a
              >
            </div>
          </div>
          <div class="col-md-6 d-flex justify-content-center">
            <div class="home-img">
              <img
                src="image/refa.jpeg"
                alt="Profile Image"
                loading="lazy"
                data-aos="fade-up"
              />
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="about" id="about" data-aos="fade-up">
      <div class="container text-center">
        <div class="content-about">
          <h2>About Me</h2>
          <p>
            Halo, saya Muhammad Refa Fatur Rahman, Mahasiswa semester 5 Teknik
            Informatika di Universitas Binaniaga Indonesia. Saya berfokus pada
            pengembangan web dan aplikasi mobile sebagai Fullstack Developer,
            dengan pengalaman mendalam di kedua sisi front-end dan back-end.
            Saya menguasai teknologi front-end seperti HTML, CSS, dan Bootstrap
            untuk menciptakan antarmuka yang interaktif, responsif, dan
            user-friendly. Di sisi back-end, saya berpengalaman menggunakan
            Express.js dan PHP untuk membangun aplikasi yang efisien dan
            scalable. Selain itu, saya juga berpengalaman dalam pengembangan
            aplikasi mobile menggunakan Flutter dan pengelolaan backend
            menggunakan Firebase untuk autentikasi dan penyimpanan data secara
            real-time. Saya juga memiliki keterampilan dalam desain grafis
            menggunakan Canva, serta penguasaan JavaScript, Node.js, dan Git
            untuk mendukung kolaborasi tim dan manajemen proyek. Saya
            berkomitmen untuk terus belajar dan menghadirkan solusi digital yang
            relevan, inovatif, dan efektif dalam setiap proyek yang saya
            kerjakan.
          </p>
        </div>
      </div>
    </section>
    <section class="project" id="project" data-aos="fade-up">
      <div class="container-fluid">
        <h2 class="mb-5">My Project</h2>
        <div class="row justify-content-center" id="project-list">
          <!-- Project cards will be injected here by JS -->
        </div>
      </div>
    </section>
    <section class="skill" id="skill" data-aos="fade-up">
      <div class="container text-center">
        <h2>My Skills</h2>
        <div
          class="row"
          style="
            display: flex;
            flex-wrap: wrap;
            gap: 2rem;
            justify-content: center;
          "
        >
          <div
            class="card"
            style="text-align: center; padding: 20px; width: 150px"
          >
            <i
              class="devicon-php-plain text-blue-400"
              style="font-size: 4rem"
            ></i>
            <p class="card-title" style="margin-top: 10px">PHP</p>
          </div>
          <div
            class="card"
            style="text-align: center; padding: 20px; width: 150px"
          >
            <i
              class="devicon-laravel-plain text-red-500"
              style="font-size: 4rem"
            ></i>
            <p class="card-title" style="margin-top: 10px">Laravel</p>
          </div>
          <div
            class="card"
            style="text-align: center; padding: 20px; width: 150px"
          >
            <i
              class="devicon-javascript-plain text-yellow-400"
              style="font-size: 4rem"
            ></i>
            <p class="card-title" style="margin-top: 10px">JavaScript</p>
          </div>
          <div
            class="card"
            style="text-align: center; padding: 20px; width: 150px"
          >
            <i
              class="devicon-nodejs-plain text-green-500"
              style="font-size: 4rem"
            ></i>
            <p class="card-title" style="margin-top: 10px">Node.js</p>
          </div>
          <div
            class="card"
            style="text-align: center; padding: 20px; width: 150px"
          >
            <i
              class="devicon-mysql-plain text-blue-400"
              style="font-size: 4rem"
            ></i>
            <p class="card-title" style="margin-top: 10px">MySQL</p>
          </div>
          <div
            class="card"
            style="text-align: center; padding: 20px; width: 150px"
          >
            <i
              class="devicon-firebase-plain text-blue-400"
              style="font-size: 4rem"
            ></i>
            <p class="card-title" style="margin-top: 10px">Firebase</p>
          </div>
          <div
            class="card"
            style="text-align: center; padding: 20px; width: 150px"
          >
            <i
              class="devicon-flutter-plain text-blue-500"
              style="font-size: 4rem"
            ></i>
            <p class="card-title" style="margin-top: 10px">Flutter</p>
          </div>
          <div
            class="card"
            style="text-align: center; padding: 20px; width: 150px"
          >
            <i
              class="devicon-android-plain text-blue-500"
              style="font-size: 4rem"
            ></i>
            <p class="card-title" style="margin-top: 10px">Android</p>
          </div>
          <div
            class="card"
            style="text-align: center; padding: 20px; width: 150px"
          >
            <i
              class="devicon-css3-plain text-blue-500"
              style="font-size: 4rem"
            ></i>
            <p class="card-title" style="margin-top: 10px">CSS</p>
          </div>
          <div
            class="card"
            style="text-align: center; padding: 20px; width: 150px"
          >
            <i
              class="devicon-bootstrap-plain text-purple-500"
              style="font-size: 4rem"
            ></i>
            <p class="card-title" style="margin-top: 10px">Bootstrap</p>
          </div>
        </div>
      </div>
    </section>

    <section class="project" id="gallery" data-aos="fade-up">
      <div class="container text-center">
        <h2>My Galery</h2>
        <div
          class="row"
          id="random-gallery"
          style="
            display: flex;
            flex-wrap: wrap;
            gap: 2rem;
            justify-content: center;
          "
        >
          <!-- Gallery images will be injected here by JS -->
        </div>
      </div>
    </section>

    <section class="project" id="serti" data-aos="fade-up">
      <div class="container text-center">
        <h2>My Certificates</h2>
        <div
          class="row"
          id="certificate-list"
          style="
            display: flex;
            flex-wrap: wrap;
            gap: 2rem;
            justify-content: center;
          "
        >
          <!-- Certificate cards will be injected here by JS -->
        </div>
      </div>
    </section>

    <section id="contact" class="contact" data-aos="fade-up">
        <div class="container text-center">
            <h2>AI Assistent</h2>
            <h3 class="mb-4">
                Have a question or need assistance? Chat with my AI assistant below!
            </h3>
            <div class="text-center" style="max-width:1000px;margin:auto;">
                <div id="ai-chat-box" style="border:1px solid #ddd;border-radius:10px;padding:20px;min-height:200px;max-height:300px;overflow-y:auto;background:#fafafa;margin-bottom:15px;text-align:left;"></div>
                <form id="ai-chat-form" autocomplete="off" style="display:flex;gap:10px;">
                    <input type="text" id="ai-chat-input" class="form-control" placeholder="Type your message..." required />
                    <button type="submit" class="btn btn-primary">Send</button>
                </form>
            </div>
        </div>
    </section>
    <script>
        // Gemini API key (replace with your own key)
        const GEMINI_API_KEY = "AIzaSyD1uGyM6rjCvwvXM6O1ndlQ8VFS1YmrRoE";

        const chatBox = document.getElementById('ai-chat-box');
        const chatForm = document.getElementById('ai-chat-form');
        const chatInput = document.getElementById('ai-chat-input');

        // Image URLs
        const userImg = "image/refa.jpeg";
        const aiImg = "image/logo.png";

        // Conversation history for context
        let conversation = [];

        function appendMessage(sender, text) {
            const msgDiv = document.createElement('div');
            msgDiv.style.margin = '10px 0';
            msgDiv.style.display = 'flex';
            msgDiv.style.alignItems = 'flex-start';

            const fontSize = '1.35rem'; // Increased font size

            if (sender === 'You') {
                msgDiv.style.justifyContent = 'flex-end';
                msgDiv.innerHTML = `
                    <span style="background:#3b82f6;color:#fff;padding:8px 16px;border-radius:16px 0 16px 16px;max-width:70%;display:inline-block;text-align:right;font-size:${fontSize};">
                        ${text}
                    </span>
                    <img src="${userImg}" alt="User" style="width:40px;height:40px;border-radius:50%;margin-left:10px;object-fit:cover;">
                `;
            } else {
                msgDiv.style.justifyContent = 'flex-start';
                msgDiv.innerHTML = `
                    <img src="${aiImg}" alt="AI" style="width:40px;height:40px;border-radius:50%;margin-right:10px;object-fit:cover;">
                    <span style="background:#e5e7eb;color:#222;padding:8px 16px;border-radius:0 16px 16px 16px;max-width:70%;display:inline-block;text-align:left;font-size:${fontSize};">
                        ${text}
                    </span>
                `;
            }
            chatBox.appendChild(msgDiv);
            chatBox.scrollTop = chatBox.scrollHeight;
        }

        async function getGeminiReply(userMsg) {
            // Add user message to conversation
            conversation.push({ role: "user", parts: [{ text: userMsg }] });

            // Prepare context for Gemini
            const contents = conversation.map(msg => ({
                role: msg.role,
                parts: msg.parts
            }));

            const url = "https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=" + GEMINI_API_KEY;
            const body = { contents };

            try {
                const res = await fetch(url, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify(body)
                });
                const data = await res.json();
                if (data && data.candidates && data.candidates[0] && data.candidates[0].content && data.candidates[0].content.parts[0].text) {
                    // Add AI reply to conversation
                    conversation.push({ role: "model", parts: [{ text: data.candidates[0].content.parts[0].text }] });
                    return data.candidates[0].content.parts[0].text.replace(/\*\*/g, "");
                } else {
                    return "Maaf, saya tidak bisa mendapatkan respon dari AI.";
                }
            } catch (err) {
                return "Maaf, terjadi kesalahan saat menghubungkan ke Gemini API.";
            }
        }

        chatForm.addEventListener('submit', async function(e) {
            e.preventDefault();
            const userMsg = chatInput.value.trim();
            if (!userMsg) return;
            appendMessage('You', userMsg);
            chatInput.value = '';
            appendMessage('', 'Typing...');
            const aiReply = await getGeminiReply(userMsg);
            // Remove "Typing..." message
            const lastMsg = chatBox.querySelectorAll('div');
            if (lastMsg.length) lastMsg[lastMsg.length - 1].remove();
            appendMessage('', aiReply);
        });
    </script>

    <section id="contact" class="contact" data-aos="fade-up">
      <div class="container text-center">
        <h2>Contact Me</h2>
        <h3 class="mb-4">
          Have a question or need assistance? Feel free to contact me via
          WhatsApp!
        </h3>
        <div class="text-center">
          <a
            href="https://wa.me/6281317490001"
            target="_blank"
            class="btn btn-primary"
            >Send Message</a
          >
        </div>
      </div>
    </section>

    <footer class="footer" data-aos="fade-up">
      <div class="container">
        <div class="row">
          <div class="col-md-12 footer-contact">
            <div class="social-links text-center">
              <a
                href="https://www.instagram.com/refafatur_/?utm_source=ig_web_button_share_sheet"
                ><i class="bi bi-instagram"></i
              ></a>
              <a href="https://www.tiktok.com/@_sixtpy?_t=ZS-8tAMrs1T3Lz&_r=1"
                ><i class="bi bi-tiktok"></i
              ></a>
              <a href="https://www.linkedin.com/in/muhammad-refa-fatur-rahman/"
                ><i class="bi bi-linkedin"></i
              ></a>
              <a href="https://github.com/refafatur"
                ><i class="bi bi-github"></i
              ></a>
            </div>
          </div>
        </div>
        <div class="footer-bottom">
          <p>&copy; 2024 Muhammad Refa Fatur Rahman.</p>
        </div>
      </div>
    </footer>
    <script src="bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="script.js"></script>
    <!-- AOS JS -->
    <script src="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.js"></script>
    <script>
      // Supabase initialization
      const supabaseUrl = "https://swsqdksyabjbafmuxljx.supabase.co";
      const supabaseKey =
        "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InN3c3Fka3N5YWJqYmFmbXV4bGp4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYxODU2MDEsImV4cCI6MjA3MTc2MTYwMX0.P1vKqCAkQD5F9O5mBqph0z-eyJ508I8-lOJs_0muchk";
      const supabase = window.supabase.createClient(supabaseUrl, supabaseKey);

      // Fetch and render Projects (tbl_project)
      async function loadProjects() {
        const { data, error } = await supabase.from("tbl_project").select("*");
        if (error) return;
        const container = document.getElementById("project-list");
        container.innerHTML = "";
        data.forEach((project) => {
          container.innerHTML += `
                <div class="col-md-8 col-lg-5 mb-4" data-aos="fade-up">
                    <div class="card h-100">
                        <img src="${project.foto}" class="card-img-top" alt="${project.nama}" loading="lazy" data-aos="fade-up">
                        <div class="card-body">
                            <h5 class="card-title">${project.nama}</h5>
                            <p class="card-text">${project.keterangan}</p>
                        </div>
                    </div>
                </div>
                `;
        });
        AOS.refresh(); // refresh AOS after DOM update
      }

      // Fetch and render Gallery (tbl_galeris)
      async function loadGallery() {
        const { data, error } = await supabase.from("tbl_galeris").select("*");
        if (error) return;
        const container = document.getElementById("random-gallery");
        container.innerHTML = "";
        data.forEach((img) => {
          const w = Math.floor(Math.random() * (480 - 220 + 1)) + 220;
          const h = Math.floor(Math.random() * (280 - 160 + 1)) + 160;
          container.innerHTML += `
                <img src="${img.foto}" alt="Galeri" class="random-img" style="width:${w}px;height:${h}px;object-fit:cover;border-radius:10px;" loading="lazy" data-aos="fade-up">
                `;
        });
        AOS.refresh();
      }

      // Fetch and render Certificates (tbl_certificates)
      async function loadCertificates() {
        const { data, error } = await supabase
          .from("tbl_certificates")
          .select("*");
        const container = document.getElementById("certificate-list");
        container.innerHTML = "";
        if (error || !data || data.length === 0) {
          container.innerHTML = "<p>Tidak ada sertifikat tersedia.</p>";
          return;
        }
        data.forEach((cert) => {
          container.innerHTML += `
            <div class="card" style="text-align: center; padding: 20px; width: 300px;" data-aos="fade-up">
                <a href="${cert.file}" target="_blank" rel="noopener noreferrer">
                    <img src="${cert.foto}" alt="${cert.nama}" style="width: 100%; height: auto;" loading="lazy" data-aos="fade-up">
                </a>
                <p class="card-title" style="margin-top: 10px;">${cert.nama}</p>
            </div>
        `;
        });
        AOS.refresh();
      }

      // Call all loaders on page load
      document.addEventListener("DOMContentLoaded", () => {
        loadProjects();
        loadCertificates();
        loadGallery();
        AOS.init({ once: true });
      });

      // Scroll reveal animation
      const observer = new IntersectionObserver((entries) => {
        entries.forEach((entry) => {
          if (entry.isIntersecting) {
            entry.target.classList.add("show");
          }
        });
      });

      document.querySelectorAll("section").forEach((section) => {
        observer.observe(section);
      });

      //   Randomize gallery image sizes on refresh
      //   Hapus kode ini karena sudah di-loadGallery
      document.querySelectorAll(".random-img").forEach((img) => {
        const size = randomSize(220, 480, 160, 280);
        img.style.width = size.width + "px";
        img.style.height = size.height + "px";
        img.style.objectFit = "cover";
        img.style.borderRadius = "10px";
      });
    </script>
    <script src="script-navbar-hide.js"></script>
  </body>
</html>
